# Outline Server –≤ Docker

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å **Outline VPN Server** –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–∏. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ VPN-—Å–µ—Ä–≤–µ—Ä–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

> ‚úÖ –ù–∞ –æ—Å–Ω–æ–≤–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ [`quay.io/outline/shadowbox`](https://github.com/OutlineFoundation/outline-server)  
> ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è  
> ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç—Ä–∏–∫ Prometheus  
> ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –±–µ–∑ `network_mode: host`

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose v2.10+
- `curl`, `openssl` (–¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
- –°–≤–æ–±–æ–¥–Ω—ã–π TCP/UDP –ø–æ—Ä—Ç 

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your/outline-docker.git
cd outline-docker

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å–∫
./start.sh
## –∏–ª–∏
make all
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è API –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤,
- –°–æ–∑–¥–∞—Å—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç,
- –ó–∞–ø—É—Å—Ç–∏—Ç Outline Server –≤ Docker,
- –°—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∞–π–ª `data/access.txt` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ Outline Manager.

---

## üìÑ –§–∞–π–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
outline-docker/
‚îú‚îÄ‚îÄ start.sh                 # –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ init/
‚îÇ   ‚îî‚îÄ‚îÄ init-outline.sh      # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml       # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ .env                     # —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ip, –ø–æ—Ä—Ç—ã –∏ —Å–µ–∫—Ä–µ—Ç—ã (–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å!)
‚îî‚îÄ‚îÄ data/
    ‚îú‚îÄ‚îÄ access.txt           # –¥–∞–Ω–Ω—ã–µ –¥–ª—è Outline Manager (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç JSON!)
    ‚îî‚îÄ‚îÄ persisted-state/     # –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
```

---

## üîê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Outline Manager

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç JSON-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```json
{"apiUrl":"https://–≤–∞—à.ip:12345/Abc123...","certSha256":"BDDBC9A4395..."}
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Outline Manager** (desktop app),
2. –ù–∞–∂–º–∏—Ç–µ **¬´+ Add Server¬ª**,
3. –í—Å—Ç–∞–≤—å—Ç–µ **–≤–µ—Å—å JSON —Ü–µ–ª–∏–∫–æ–º** (–≤–∫–ª—é—á–∞—è —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏),
4. –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª—é—á–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞.

---

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
docker compose down
docker compose up -d
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Outline
```bash
docker compose pull shadowbox
docker compose up -d
```

> ‚ö†Ô∏è –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./data/persisted-state` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
docker compose logs -f shadowbox
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **API-–ø–æ—Ä—Ç** –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º—É HTTPS —Å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º,
- **–î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤** —à–∏—Ñ—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Shadowsocks (chacha20-ietf-poly1305),
- **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–µ—Ä–≤–µ—Ä–∞,
- **–ü–æ—Ä—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ** ‚Äî —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

Outline –≤–∫–ª—é—á–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Prometheus-—Å–µ—Ä–≤–µ—Ä –Ω–∞ `localhost:9090` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.  
–ß—Ç–æ–±—ã —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏:

1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –≤ `docker-compose.yml`:
   ```yaml
   ports:
     - "127.0.0.1:9090:9090"
     - "127.0.0.1:9091:9091"
     - "127.0.0.1:9092:9092"
   ```
2. –î–æ–±–∞–≤—å—Ç–µ –≤ `prometheus.yml`:
   ```yaml
   - targets: ['localhost:9090', 'localhost:9091', 'localhost:9092']
   ```
3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ **ID 11899** –≤ Grafana.

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

- –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ [Outline Server](https://getoutline.org), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ [Apache License 2.0](https://github.com/Jigsaw-Code/outline-server/blob/master/LICENSE).
- –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî open source, –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–≤–æ–±–æ–¥–Ω–æ.